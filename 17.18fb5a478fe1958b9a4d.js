(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{qkBK:function(t,e,n){"use strict";n.r(e),n.d(e,"HomePageModule",function(){return y});var i=n("PCNd"),s=n("ofXK"),c=n("3Pt+"),a=n("TEn/"),o=n("tyNb"),r=n("V2kc"),h=n("fXoL"),l=n("i+vR"),b=n("j7lE"),u=n("fKaL"),g=n("Mm3c"),d=n("rEJb");const p=["chatsContainer"];function f(t,e){if(1&t&&h.Kb(0,"chat-item",9),2&t){const t=e.$implicit,n=h.Wb(2);h.ac("routerLink","/chat/",t.receiverId,""),h.Zb("newMessageCounter",t.newMessages)("latestMessage",t.latestMessage)("myId",n.loggedUser.id)("label",t.receiverName)}}function m(t,e){if(1&t&&(h.Mb(0,"div",5),h.Mb(1,"ion-virtual-scroll",6,7),h.hc(3,f,1,5,"chat-item",8),h.Lb(),h.Lb()),2&t){const t=h.Wb();h.zb(1),h.Zb("trackBy",t.trackById)("items",t.chats)}}function M(t,e){1&t&&(h.Mb(0,"div",10),h.Kb(1,"ion-spinner",11),h.Lb())}function C(t,e){1&t&&(h.Mb(0,"div",10),h.Kb(1,"empty",12),h.Lb())}const w=[{path:"",component:(()=>{class t{constructor(t,e,n){this.chatService=t,this.usersService=e,this.websocketService=n,this.Status=r.f,this.currentStatus=r.f.loading,this.chats=[],this.loggedUser=new r.g}set content(t){t&&(this.chatContainer=t)}ngOnInit(){this.loggedUser=this.usersService.loggedUser,this.subscription=this.websocketService.message.asObservable().subscribe(t=>{if(t){for(let n of this.chats)if(n.chatId==t.chatId){const e=this.chats.indexOf(n);return n.latestMessage=t,n.newMessages++,this.chats.unshift(this.chats.splice(e,1).pop()),void(this.chatContainer&&this.chatContainer.checkEnd())}const e=new r.a;e.chatId=t.chatId,e.receiverId=t.senderId,e.receiverName=t.senderName,e.latestMessage=t,e.newMessages++,this.chats.unshift(e),this.currentStatus=r.f.loaded,this.chatContainer&&this.chatContainer.checkEnd()}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}ionViewWillEnter(){this.getChats()}trackById(t,e){return e.chatId}getChats(){this.currentStatus=r.f.loading,this.chatService.getUserChats().subscribe(t=>{if(this.chats=t,0==this.chats.length)return this.currentStatus=r.f.empty;this.currentStatus=r.f.loaded})}}return t.\u0275fac=function(e){return new(e||t)(h.Jb(l.a),h.Jb(b.a),h.Jb(u.a))},t.\u0275cmp=h.Db({type:t,selectors:[["app-home"]],viewQuery:function(t,e){if(1&t&&h.mc(p,1),2&t){let t;h.cc(t=h.Vb())&&(e.content=t.first)}},decls:10,vars:4,consts:[[1,"container","title-container"],["name","chatbubble-ellipses-outline"],[3,"ngSwitch"],["class","container",4,"ngSwitchCase"],["class","status",4,"ngSwitchCase"],[1,"container"],[3,"trackBy","items"],["chatsContainer",""],[3,"newMessageCounter","latestMessage","routerLink","myId","label",4,"virtualItem"],[3,"newMessageCounter","latestMessage","routerLink","myId","label"],[1,"status"],["color","primary"],["text","No has iniciado ninguna conversaci\xf3n","icon","chatbox-ellipses-outline"]],template:function(t,e){1&t&&(h.Mb(0,"ion-header"),h.Mb(1,"ion-toolbar"),h.Mb(2,"div",0),h.Mb(3,"span"),h.ic(4," Conversaciones "),h.Lb(),h.Kb(5,"ion-icon",1),h.Lb(),h.Lb(),h.Lb(),h.Mb(6,"ion-content",2),h.hc(7,m,4,2,"div",3),h.hc(8,M,2,0,"div",4),h.hc(9,C,2,0,"div",4),h.Lb()),2&t&&(h.zb(6),h.Zb("ngSwitch",e.currentStatus),h.zb(1),h.Zb("ngSwitchCase",e.Status.loaded),h.zb(1),h.Zb("ngSwitchCase",e.Status.loading),h.zb(1),h.Zb("ngSwitchCase",e.Status.empty))},directives:[a.k,a.w,a.l,a.h,s.l,s.m,a.x,a.F,g.a,a.C,o.h,a.r,d.a],styles:["ion-content[_ngcontent-%COMP%]{contain:size style}.title-container[_ngcontent-%COMP%]{align-items:center;display:flex;font-size:25px!important;font-weight:300;justify-content:center;margin-bottom:20px;margin-top:20px}.title-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:20px}.status[_ngcontent-%COMP%]{height:80vh;width:100vw}.icon-container[_ngcontent-%COMP%], .status[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center}.icon-container[_ngcontent-%COMP%]{background-color:var(--ion-color-primary);border-radius:100%;height:40px;margin:10px 20px 10px 10px;padding:5px;width:40px}.icon-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff;transform:scale(1.25)}ion-refresher[_ngcontent-%COMP%]{position:relative!important}ion-fab[_ngcontent-%COMP%]{z-index:20!important}.send[_ngcontent-%COMP%]{margin-left:auto;transform:scale(.75)}"]}),t})()}];let v=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.Hb({type:t}),t.\u0275inj=h.Gb({imports:[[o.i.forChild(w)],o.i]}),t})(),y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.Hb({type:t}),t.\u0275inj=h.Gb({imports:[[s.b,c.f,a.y,i.a,v]]}),t})()}}]);